<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Local CSS and DIY night mode – Ospalh’s Anki2 addons</title>
    <link rel="icon" type="image/png" href="/anki-addons/images/オ.png"/>
    <link rel="apple-touch-icon" href="/anki-addons/images/オ.png"/>
    <link rel="stylesheet/less" type="text/css" href="/anki-addons/css/styles.less">
    
    <script src="/anki-addons/scripts/less-1.3.0.min.js" type="text/javascript"></script>
    <!-- Internet Explorer HTML5 enabling script: -->
    <!--[if IE]>
    <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <style type="text/css"> .clear {zoom: 1;display: block;} figure img{display:block;} </style>
    <![endif]-->
  </head>
  <body>
    <section id="page">
      <header>
        <nav class="clear">
          <ul>
            <li><a href="/">Home</a></li>
            <li><a href="/anki-addons/">Anki add-ons</a></li>
            
            <li><a href="https://github.com/ospalh/anki-addons" class="code">GitHub project</a></li>
            <li><a href="https://github.com/ospalh/anki-addons/tarball/master" class="download-button">Project tarball</a></li>
            <li><a href="https://github.com/ospalh/anki-addons/zipball/master" class="download-button zip">Project zipball</a></li>
            
      <li><a href="https://github.com/ospalh/anki-addons/blob/master/local_css_and_diy_night_mode.py" class="code">Add-on source</a></li>

      <li><a href="https://ankiweb.net/shared/info/2587372325">AnkiWeb</a></li>
      <li><span>ID: 2587372325</span></li>


          </ul>
        </nav>
      
  <h1>Local CSS and DIY night mode</h1>
  
  <h3>Adapt card styles to time and place</h3>
  

      </header>
      
<article id="localcss" class="clear">
  <div class="articleBody">

    <figure>
      <img src="/anki-addons/images/three_styles.png" alt="An Anki review window, split and showing different fonts and color schemes in different parts." />
     <figcaption>The same card with different styles</figcaption>
    </figure>

    
    <p>This loads the local CSS file <code>user_style.css</code> and adds the style to
the CSS set in the card templates.</p>
<p>It also adds a few classes to the cards.</p>
<p>With this, the look of the cards can be adapted to the time of day
(night colors) and place (small fonts on small screens, big fonts on
big screens, ...)</p>
<h2>Set-up</h2>
<p>The add-on loads the file <code>user_style.css</code> from the current profile’s
directory, typically <code>Anki/User 1</code> or <code>Anki\User 1</code>.</p>
<p>Typically the standard styling in the card template isn’t
changed. Like this, reviewing on AnkiWeb and on mobile devices works
as before.</p>
<h3>Classes</h3>
<p>The add-on adds the classes <code>loc</code> to all cards. The model and template
names of each card are reduced to the characters <code>a</code> to <code>z</code>, <code>A</code> to
<code>Z</code>, <code>0</code> to <code>9</code> and <code>_</code> and added as classes as well, in the form of
<code>model_NN</code> and <code>template_NN</code>. As an example, the second card of a
model or note type called “Satz Japanese 日本語” and that is called
“Hörübung” would have the CSS classes <code>loc card card2
model_SatzJapanese template_Hrbung</code>. These classes can be used to
build CSS selectors.</p>
<h3>Standard use</h3>
<p>To apply a style to the whole card only on a specific computer, use the
<code>user_sytle.css</code> file on that computer. You should use the CSS selector
<code>.loc.card</code>. The example in the bottom of the image was done with
<blockquote><pre><code>.loc.card{
  font-family: Linux Biolinum O;
  background-color: #ededff;
  font-size: 58px;}</code></pre></blockquote></p>
<blockquote class=nb> The selector in the style file must be more
specific than the one used in the template in the collection. When a
setup for <code>.card</code> is used in the template, the style file should use
<code>.loc.card</code>, not just <code>.loc</code> </blockquote>

<h3>Sub-elements</h3>
<p>The easiest way to select only parts of a card is to add classes with
the <code>&lt;div&gt;</code> or <code>&lt;span&gt;</code> elements. For example a Japanese answer can be
written as <code>&lt;div class="nihongo"&gt;{{furigana:Japanese}}&lt;/div&gt;</code> in the
back template of a card.</p>
<p>Then, different Japanese fonts can be selected on different computers
by using <code>.loc .nihongo{font-family:
<a href="http://ossipedia.ipa.go.jp/ipafont/index.html">IPAPMincho</a>;}</code> in
one style file and <code>.loc .nihongo{font-family:
"<a href="http://cooltext.com/Download-Font-%E6%9C%88+Moon">Moon font</a>";}</code>
in another.</p>
<blockquote class=nb>
As the <code>loc</code> and <code>card</code> apply to the same object, the
selector <code>.loc.card</code> contains <em>no</em> space. When setting
the style for a sub-element, a space <em>must</em> be added. For
example, to change the style of the Japanese text, use <code>.loc
.nihongo</code> with a space between the <code>c</code> and the <code>.</code>.
</blockquote>

<h2>Different cards</h2>
<p>Applying different styles to different cards works in a similar way.</p>
<p>As an example, in the past i used a standard style of black on light blue for
standard cards and black and light red for grammar cards. In the
alternative style i used light colored text on dark background, dark
green for normal cards and dark red for grammar cards. The standard
cards use the the <code>.loc.card</code> selector described above. The model name
of the grammar cards is “Grammatik VHS — Japanese” and so i used
<blockquote><pre><code>.loc.card.model_grammatikvhsjapanese{
  background-color: #64354c;
  color: #d9b7ce;}</code></pre></blockquote>
to set up the pink-on-dark-red.</p>
<h2>Night mode</h2>
<p>The add-on adds a “Mode (extra class)” sub-menu to the “Edit” menu to
switch between night mode and normal (day) mode.</p>
<blockquote class="nb">
Without further set-up, this switch has no visible effect,
all it does is add another class <code>night</code>. The user has to set up
eir collection to make use of this.
</blockquote>

<h3>Set-up</h3>
<p>The set-up is best done in the <code>user_style.css</code> file. To use
white-on-black as a night mode alternative to standard black-on-white
cards, you should add
<blockquote><pre><code>.night.card.loc {
  color: white;
  background-color: black;}
</code></pre></blockquote></p>
<p>It is also possible to add definitions for <code>.night</code> in the card
templates themselves. This way it will probably work with the
AnkiDroid code i intend to write to bring night mode there.</p>
<h3>More modes</h3>
<p>More display modes can be used. Edit the
<a href="https://github.com/ospalh/anki-addons/blob/master/local_css_and_diy_night_mode.py">source file</a>.</p>
<p>Look for “<code>extra_classes_list</code>” near the top. Duplicate the <code>Night
mode</code> line and change the texts <em>after</em> the <code>class</code> and <code>display</code>
bits.</p>
<p>For example, i use the
“<a href="http://ethanschoonover.com/solarized">solarized</a>” color schemes. I
use the light theme most of the time but sometimes want the dark
theme. I also sometimes want to see the cards in black-on-white.</p>
<p>The point here is that the dark scheme can’t really be derived from
the light mode, so it <em>has</em> to be set explicitly in a style sheet.</p>
<p>The relevant bits of my templates look like this:
<blockquote><pre><code>.card {
  color: #657b83;
  background-color: #fdf6e3;
}
.night.card {
  color: #839496;
  background-color: #002b36;
}
.highc.card {
  color: black;
  background-color: white;
}</code></pre></blockquote></p>
<p>And i have added “<code>highc</code>” as entry to the menu:
<blockquote><pre><code>extra_classes_list = [
    {'class': 'night', 'display': u'Night mode'},
    {'class': 'highc', 'display': u'High contrast mode'},
    ]</code></pre></blockquote></p>
<h3>No night mode</h3>
<p>Similarly, the mode switch menu can be turned off by deleting the
night mode line of the <code>extra_classes_list</code> in the source.</p>
<h2>Different styles through different files</h2>
<p>The old way to use different styles at different times was to have two
style files like <code>day_user_style.css</code> and <code>night_user_style.css</code> handy
and replace the file <code>user_style.css</code> with the fitting one. On file
systems that support them (i.e. basically anywhere but on Windows
systems), soft links can be used instead: <code>ln -sf day_user_style.css
user_style.css</code>.</p>
<h3>Reloading</h3>
<p>The user style is loaded when the profile is opened. To reload the
style after a change go to the “Switch Profiles” dialog and re-open the
profile.</p>
<h2>AnkiDroid</h2>
<p>People that like to build their own AnkiDroid version can take a look
at the
<a href="https://github.com/ospalh/Anki-Android/tree/feature-diy-night-mode">branch</a>
i have made a that sets extra classes for the night mode. That patch
switches off the normal color reversal of the AnkiDroid night mode and
entirely relies on the colors being changed in the notes’ CSS. Take a
look at the code changes for details on how to set up the classes.</p>
<p>It is probably a good idea to merge the branch into the newest
AnkiDroid development branch rather than to use it as is.</p>
    
  </div>

</article>

      <footer>
        <div class="line"></div>
        <span class="by"><a href="https://github.com/ospalh">ospalh</a>
        maintains <a href="https://github.com/ospalh/anki-addons">anki-addons</a></span>
        <a href="http://tutorialzine.com/" class="tmpl">Original
        template: Tutorialzine</a>
      </footer>
    </section>
  
</body>
</html>